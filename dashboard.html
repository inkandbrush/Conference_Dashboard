<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>EMG Dashboard</title>
  <style>
    body {
      /*background-color: red;*/
		background-image: url('db.png');
      font-family: Arial, sans-serif;
      color: white;
      padding: 20px;
    }
    header, footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px;
      /*background-color: #b30000;*/
    }
    header img, footer img {
      height: 50px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      background-color: white;
      color: black;
    }
    th, td {
      padding: 10px;
      border: 1px solid #ccc;
    }
    select {
      margin-bottom: 20px;
    }
  </style>
</head>
<body>
  <header>
    <img src="PML.png" alt="PML Logo">
	  <img src="leaderboard.png" alt="Leaderboard">
    <img src="logo.png" alt="JOGO Logo">
  </header>

  <h2>EMG Scoreboard</h2>
  <label>Filter by Region:
    <select id="regionFilter" onchange="filterByRegion()">
      <option value="">Select Region</option>
      <option value="Region 1">Region 1</option>
      <option value="Region 2">Region 2</option>
      <option value="Region 3">Region 3</option>
      <option value="Region 4">Region 4</option>
    </select>
  </label>
  <button onclick="goBack()">Back to Form</button>

  <table>
    <thead>
      <tr>
        <th>Sr.No</th>
        <th>Dr Name</th>
        <th>Speciality</th>
        <th>CT</th>
        <th>EMG</th>
        <th>Region</th>
      </tr>
    </thead>
    <tbody id="dataBody"></tbody>
  </table>

  <footer>
    <img src="footer.png" alt="WCW Logo">
  </footer>

  <script>
  window.addEventListener("DOMContentLoaded", function () {
    const API_URL = "https://api.sheetbest.com/sheets/ff225d89-144f-406a-86b9-17ac69c2961e";

    async function fetchData() {
      const res = await fetch(API_URL);
      const data = await res.json();
      return data.sort((a, b) => {
        const emgA = parseFloat(a.EMG) || 0;
        const emgB = parseFloat(b.EMG) || 0;
        return emgB - emgA;
      });
    }

    function renderTable(data) {
      const tbody = document.querySelector("#emgTable tbody");
      if (!tbody) return console.error("❌ tbody not found");
      tbody.innerHTML = "";
      data.forEach((row, index) => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${index + 1}</td>
          <td>${row.DrName}</td>
          <td>${row.Speciality}</td>
          <td>${row.SSMName}</td>
          <td>${row.EMG}</td>
          <td>${row.Region}</td>
        `;
        tbody.appendChild(tr);
      });
    }

    function populateFilter(data) {
      const select = document.getElementById("regionFilter");
      const regions = [...new Set(data.map(r => r.Region))];
      regions.forEach(region => {
        const opt = document.createElement("option");
        opt.value = region;
        opt.textContent = region;
        select.appendChild(opt);
      });

      select.addEventListener("change", () => {
        const filtered = select.value
          ? data.filter(r => r.Region === select.value)
          : data;
        renderTable(filtered);
      });
    }

   

    async function init() {
      const data = await fetchData();
      renderTable(data);
      populateFilter(data);
    }

    init();
  });
</script>
</body>
</html>
